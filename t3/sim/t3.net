*
* Low-Pass Filter + Limiter
*

* forces current values to be saved
.options savecurrents

******************************************
* input voltage source
vS 0 1 0.0 sin(0 220 50)
* vS 1 0 0 sin(0 5 400)


Ci 2 3 8u
Ri 2 3 4k

* positive limiter
Dp1 0 3 Default
Dp2 2 1 Default
Dp3 1 3 Default
Dp4 2 0 Default


*pre source v(3) -v(2)

R2 3 4 3k

Dp4 4 5 Default
Dp5 5 6 Default
Dp6 6 7 Default
Dp7 7 8 Default
Dp8 8 9 Default
Dp9 9 10 Default
Dp10 10 11 Default
Dp11 11 12 Default
Dp12 12 13 Default
Dp13 13 14 Default
Dp14 14 15 Default
Dp15 15 16 Default
Dp16 16 17 Default
Dp17 17 18 Default
Dp18 18 19 Default
Dp19 19 2 Default
*Dp20 20 2 Default
*Dp21 21 22 Default


.model Default D
.op
.end

.control

******************************************
* analise no tempo
tran 5e-4 100e-3
* tran 1e-5 10e-3

plot v(3)-v(2) v(1)

******************************************
hardcopy solution1.ps v(4)-v(2)
echo solution1_FIG

hardcopy solution12.ps (v(4)-v(2)-12)
echo solution12_FIG

hardcopy solution2.ps v(3)-v(2)
echo solution2_FIG

.endc

.measure tran yavg4 AVG v(4) from=20m to=80m
.measure tran yavg2 AVG v(2) from=20m to=80m

.measure tran YavgDiff param='yavg4 - yavg2'

.measure tran yavg3 AVG v(3) from=20m to=80m

.measure tran YavgDiffRect param='yavg3 - yavg2'

*nao serve
.measure tran v4max MAX v(4) from=20m to=80m
.measure tran v2max MAX v(2) from=20m to=80m
.measure tran v4min MIN v(4) from=50m to=80m
.measure tran v2min MIN v(2) from=50m to=80m

.measure tran ripple1 param='v4max - v2min'
.measure tran ripple2 param='v4min - v2max'

